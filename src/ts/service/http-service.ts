import {HttpInterface} from './http-interface';
import axios, { AxiosError} from 'axios';

const HTTP_REQUEST_TIMEOUT = 12000; // HTTP timeout 시간 설정

export class HttpService implements HttpInterface {
    /**
	 * @method getSnapShot
	 * @description 미디어서버 스냅샷 요청
	 * @returns
	 */
	public async getSnapShot(url: string): Promise<Blob|null> {
		const response = await axios.get(url, {
			method: 'GET',
			timeout: HTTP_REQUEST_TIMEOUT,
            /*
			headers: {
                'Authorization': 'Bearer ' + 'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2WExaa0NFN0VOVW53SEJBaFRTOHJwczNrcmNrRjZYWkdXbGlMclM1VTV3In0.eyJleHAiOjE2Mzk3MTM4MTEsImlhdCI6MTYzOTcxMzIxMSwianRpIjoiZWFhMWQzODAtOWJkYy00N2I1LTgxMGQtNjE0YTNlNzBhZjE2IiwiaXNzIjoiaHR0cDovL2NhLTE3Mi0xNi0zNi0xODAudnVyaXgua3IvYXV0aC9yZWFsbXMvdnVyaXgtZG1zIiwiYXVkIjoidnVyaXgtZG1zLXBsYXRmb3JtIiwic3ViIjoiMzAxZThmZWYtOTNlZi00ZDg5LWJkYzQtMjJmNjMxNjhkZGZkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoidnVyaXgtZG1zLXBsYXRmb3JtIiwic2Vzc2lvbl9zdGF0ZSI6Ijc0OWFlOTZjLWI0ZDktNDZhMC1iZjkxLTgwOGY3MWVlZTgyZiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovL2V4cG9ydC0xNzItMTYtMzYtMTgwLnZ1cml4LmtyIiwiaHR0cDovL2xvY2FsaG9zdDoxMjM0IiwiaHR0cHM6Ly9sZy0xNzItMTYtMzYtMTgwLnZ1cml4LmtyIiwiaHR0cDovLzExMi4yMTYuMTYwLjExODo4MDgwIiwiaHR0cDovL2NhLTE3Mi0xNi0zNi0xODAudnVyaXgua3IiLCJodHRwczovL2tjLTE3Mi0xNi0zNi0xODAudnVyaXgua3IiLCJodHRwOi8vMTAuMS43My43OjgxODAiLCJodHRwOi8vMTcyLjE2LjM2LjE4MCIsImh0dHA6Ly9sb2NhbGhvc3Q6OTk5OSIsImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMCIsImh0dHBzOi8vMTEyLjIxOS42OS4yMTA6MTY4MDgiLCJodHRwOi8vMTEyLjIxOS42OS4yMTA6MTY4MDgiLCJodHRwczovLzE3Mi4xNi4zNi4xODAiLCJodHRwOi8vbG9jYWxob3N0OjgwODAiLCJodHRwczovLzEwOC4xLjE0My4yNjo4MCIsImh0dHBzOi8vc3NsLTE3Mi0xNi0zNi0xODAudnVyaXgua3IiLCJodHRwOi8vMTA4LjEuMTQzLjI2OjgwIiwiaHR0cHM6Ly9jYS0xNzItMTYtMzYtMTgwLnZ1cml4LmtyIiwiaHR0cDovLzIxMC4xMDEuMTAzLjkxOjgxODAiLCJodHRwOi8va2MtMTcyLTE2LTM2LTE4MC52dXJpeC5rciJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiQk9BUkQiLCJTTUFSVF9QQVJLSU5HX0xPVCIsIkxWU1RDSyIsIlNZU1RFTSIsIk1PSlVDMTEwIiwiTU5EMTAwIiwiQVNFVF9NQVAiLCJERUNJU0lPTiIsIkFTRVRfRkFVTFQiLCJBU0VUX0NBVCIsIkFTRVRfV09SSyIsIk1PTklUT1JJTkciLCJDQVJfTlVNIiwiSU5URVJFU1RFRF9WRUhJQ0xFIiwiTk1TX0RBU0hCT0FSRCIsIkVWRU5UIiwiRU5VTV9NTkdUIiwiSU5TVEFMTF9SRVEiLCJSRVBPUlRfUkVTVUxUIiwiQVNFVF9MSVNUIiwiU0VUVElORyIsIkdFT01FWF9BU1NFVF9NTkdUIiwiTkRNU19XRUFUSEVSIiwiTU9CSUxJVFkiLCJST0xFX01OR1QiLCJFTUVSX1JPVVRFIiwiTEVHRU5EX01OR1QiLCJTTUUiLCJFWFRFUk5BTF9HSVMiLCJCSUdEQVRBX1JFUE9SVCIsIlNNQVJUX1NFQVJDSCIsIk1JU1NJTkdfTU5HVCIsIkVNQVBfTU5HVCIsIk5PVElDRV9NTkdUIiwiV0FTMzAwIiwiTk9USUNFIiwiQU5TSU1JIiwiQVNTRVRfU0VUIiwiQVNFVF9WTVMiLCJBU1NFVF9NTkdUIiwiTVNHX1RQTF9NTkdUIiwiUE9QVUxBVElPTl9GTE9XIiwiRVhURVJOQUxfUEFHRSIsIkNPREVfTU5HVCIsIk5FVFdPUktfTk1HVCIsIkxBWUVSX01OR1QiLCJTWVNURU1fTU5HVCIsIkxFR0VORF9BU1NFVCIsIkRBU0hCT0FSRCIsIlVTRVJfTU5HVCIsIk5ETVNfSU5GTyIsIlBMUFIiLCJFUElERU1JQyIsIkVYVEVSTkFMX1BBR0U3IiwiRVhURVJOQUxfUEFHRTgiLCJJTlNUQUxMX1JFUV9NTkdUIiwiSU5TVEFMTF9HVUlERSIsIlBTQzEwMCIsIlNBRkVfTUFQIiwiVEVTVFRUVF9TVUIzIiwiQVNTRVQiLCJCSVoiLCJFVkVOVF9NT05JVE9SIiwiSElTVE9SWSIsIkxFR0VORF9NT04iXX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgdnVyaXgtZG1zLXBsYXRmb3JtIHBob25lIiwiYXJlYSI6IkNIRU9OQU4iLCJtb2JpbGUiOiIiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiLsnbTrhbjrjoEiLCJncm91cCI6WyLsspzslYjqtIDrpqzsnpDqt7jro7kiXX0.CXlSkCOY9qreDyr1sCKMYGZp0gpZ5yInB8ms9i53ju0xKesrLoFNzul8zekMXlfGzPziqMqqoWEijkyah6ktrQs8tvEjbFqf3mGrZeGOSKqrvIyOlgCtzmz_Rk8IJNmnv3OmZ8ImRZ6qx27Itc2z3T2E7eb-jsEIDR7Avf-uyVRBrZFVkiJLMTyyZ0DYvkEYSHzYKjCAWWqRMEsGFZI4nWrSU41J40oIl2MjTbAJEF5mV05cHky57eUW1qJUhqCYhc1utirfGIiTTAnvTvqx8KjQS_LZGvJr5Yw-BdI5FC59qP9OQ2IixszP6gCIfXBkfsOdHVAQODKytWGkMOM17g'
            },
			*/
            responseType: 'blob'
		}).catch((err: Error | AxiosError) => {
			if (axios.isAxiosError(err))  {
				console.log(`[ERROR] HTTP GET REQUEST, URL: ${url} => ${err}`);
			}
		});

		if (response && response.status == 200) {
			return response.data;
		}

		return Promise.resolve(null);
	}
}